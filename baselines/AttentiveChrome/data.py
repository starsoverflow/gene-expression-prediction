
import torch
import collections
import pdb
import torch.utils.data
import csv
import json
from torch.utils.data import Dataset, DataLoader
from torchvision import transforms, utils
import math
import pandas as pd
import numpy as np

from sklearn.impute import KNNImputer

DATA_DIR = "../../processed_data/"
BIN_COUNT = 200
BATCH_SIZE = 16


esc_all_names = ["A02","A03","A04","A05","A06","A07","A09","B01","B02","B03","B04","B05","B06","B07","B09","C01","C02","C03","C04","C05","C07","C09","D01","D05","D06","D07","D09","E01","E02","E03","E05","E07","E09","F02","F03","F04","F05","F06","F07","F09","G01","G02","G03","G05","G06","G07","G09","H02","H03","H09"]


selected_genes = ['ENSMUSG00000021807', 'ENSMUSG00000024151', 'ENSMUSG00000024217', 'ENSMUSG00000027170', 'ENSMUSG00000031578', 'ENSMUSG00000035885', 'ENSMUSG00000036097', 'ENSMUSG00000040225', 'ENSMUSG00000057113', 'ENSMUSG00000058126', 'ENSMUSG00000063200']

# dna meth<0
selected_genes = ['ENSMUSG00000000563', 'ENSMUSG00000000751', 'ENSMUSG00000001016', 'ENSMUSG00000001707', 'ENSMUSG00000005312', 'ENSMUSG00000010554', 'ENSMUSG00000015341', 'ENSMUSG00000016833', 'ENSMUSG00000017861', 'ENSMUSG00000018326', 'ENSMUSG00000018770', 'ENSMUSG00000019210', 'ENSMUSG00000020863', 'ENSMUSG00000021807', 'ENSMUSG00000022820', 'ENSMUSG00000023110', 'ENSMUSG00000023764', 'ENSMUSG00000024151', 'ENSMUSG00000024217', 'ENSMUSG00000024525', 'ENSMUSG00000024661', 'ENSMUSG00000025326', 'ENSMUSG00000026078', 'ENSMUSG00000026810', 'ENSMUSG00000026895', 'ENSMUSG00000027170', 'ENSMUSG00000027447', 'ENSMUSG00000028318', 'ENSMUSG00000028426', 'ENSMUSG00000028648', 'ENSMUSG00000028861', 'ENSMUSG00000028884', 'ENSMUSG00000029363', 'ENSMUSG00000029415', 'ENSMUSG00000030042', 'ENSMUSG00000030342', 'ENSMUSG00000031527', 'ENSMUSG00000031546', 'ENSMUSG00000031578', 'ENSMUSG00000031715', 'ENSMUSG00000031796', 'ENSMUSG00000031939', 'ENSMUSG00000032897', 'ENSMUSG00000033075', 'ENSMUSG00000035885', 'ENSMUSG00000036097', 'ENSMUSG00000036371', 'ENSMUSG00000036781', 'ENSMUSG00000038683', 'ENSMUSG00000038717', 'ENSMUSG00000039224', 'ENSMUSG00000040025', 'ENSMUSG00000040225', 'ENSMUSG00000041841', 'ENSMUSG00000042541', 'ENSMUSG00000045699', 'ENSMUSG00000050240', 'ENSMUSG00000051176', 'ENSMUSG00000051695', 'ENSMUSG00000054717', 'ENSMUSG00000057113', 'ENSMUSG00000058126', 'ENSMUSG00000058600', 'ENSMUSG00000061607', 'ENSMUSG00000063200', 'ENSMUSG00000066442', 'ENSMUSG00000068856', 'ENSMUSG00000078974', 'ENSMUSG00000093904']

# r>0.1
#selected_genes = ['ENSMUSG00000000184', 'ENSMUSG00000000194', 'ENSMUSG00000000325', 'ENSMUSG00000000730', 'ENSMUSG00000000976', 'ENSMUSG00000001983', 'ENSMUSG00000002257', 'ENSMUSG00000002326', 'ENSMUSG00000002342', 'ENSMUSG00000002733', 'ENSMUSG00000003033', 'ENSMUSG00000004266', 'ENSMUSG00000004558', 'ENSMUSG00000005069', 'ENSMUSG00000005621', 'ENSMUSG00000006169', 'ENSMUSG00000006276', 'ENSMUSG00000006369', 'ENSMUSG00000007721', 'ENSMUSG00000008435', 'ENSMUSG00000009894', 'ENSMUSG00000015568', 'ENSMUSG00000017837', 'ENSMUSG00000018412', 'ENSMUSG00000018841', 'ENSMUSG00000019841', 'ENSMUSG00000019842', 'ENSMUSG00000019845', 'ENSMUSG00000019854', 'ENSMUSG00000019907', 'ENSMUSG00000019917', 'ENSMUSG00000019920', 'ENSMUSG00000020300', 'ENSMUSG00000020362', 'ENSMUSG00000020422', 'ENSMUSG00000020448', 'ENSMUSG00000020521', 'ENSMUSG00000020766', 'ENSMUSG00000020808', 'ENSMUSG00000020859', 'ENSMUSG00000021235', 'ENSMUSG00000021413', 'ENSMUSG00000021451', 'ENSMUSG00000021532', 'ENSMUSG00000021621', 'ENSMUSG00000021775', 'ENSMUSG00000022159', 'ENSMUSG00000022304', 'ENSMUSG00000022337', 'ENSMUSG00000022559', 'ENSMUSG00000022574', 'ENSMUSG00000022897', 'ENSMUSG00000022948', 'ENSMUSG00000023026', 'ENSMUSG00000023118', 'ENSMUSG00000023892', 'ENSMUSG00000024037', 'ENSMUSG00000024260', 'ENSMUSG00000024269', 'ENSMUSG00000024293', 'ENSMUSG00000024301', 'ENSMUSG00000024454', 'ENSMUSG00000024622', 'ENSMUSG00000025006', 'ENSMUSG00000025077', 'ENSMUSG00000025137', 'ENSMUSG00000025354', 'ENSMUSG00000025533', 'ENSMUSG00000025815', 'ENSMUSG00000026003', 'ENSMUSG00000026027', 'ENSMUSG00000026036', 'ENSMUSG00000026198', 'ENSMUSG00000026199', 'ENSMUSG00000026201', 'ENSMUSG00000026317', 'ENSMUSG00000026342', 'ENSMUSG00000026584', 'ENSMUSG00000026705', 'ENSMUSG00000026784', 'ENSMUSG00000026927', 'ENSMUSG00000026955', 'ENSMUSG00000027303', 'ENSMUSG00000027438', 'ENSMUSG00000027805', 'ENSMUSG00000028126', 'ENSMUSG00000028479', 'ENSMUSG00000028488', 'ENSMUSG00000028528', 'ENSMUSG00000028581', 'ENSMUSG00000028607', 'ENSMUSG00000028709', 'ENSMUSG00000028710', 'ENSMUSG00000028850', 'ENSMUSG00000029482', 'ENSMUSG00000030101', 'ENSMUSG00000030104', 'ENSMUSG00000030263', 'ENSMUSG00000030313', 'ENSMUSG00000030347', 'ENSMUSG00000030374', 'ENSMUSG00000030423', 'ENSMUSG00000030861', 'ENSMUSG00000031478', 'ENSMUSG00000031487', 'ENSMUSG00000031516', 'ENSMUSG00000031548', 'ENSMUSG00000031600', 'ENSMUSG00000031608', 'ENSMUSG00000031758', 'ENSMUSG00000031907', 'ENSMUSG00000031935', 'ENSMUSG00000031959', 'ENSMUSG00000032220', 'ENSMUSG00000032262', 'ENSMUSG00000032350', 'ENSMUSG00000032422', 'ENSMUSG00000032497', 'ENSMUSG00000032513', 'ENSMUSG00000032547', 'ENSMUSG00000032688', 'ENSMUSG00000032782', 'ENSMUSG00000032815', 'ENSMUSG00000033253', 'ENSMUSG00000033669', 'ENSMUSG00000034105', 'ENSMUSG00000034108', 'ENSMUSG00000034247', 'ENSMUSG00000034329', 'ENSMUSG00000034460', 'ENSMUSG00000034636', 'ENSMUSG00000034773', 'ENSMUSG00000034781', 'ENSMUSG00000035064', 'ENSMUSG00000035329', 'ENSMUSG00000035671', 'ENSMUSG00000035824', 'ENSMUSG00000036087', 'ENSMUSG00000036275', 'ENSMUSG00000036282', 'ENSMUSG00000036291', 'ENSMUSG00000036435', 'ENSMUSG00000036591', 'ENSMUSG00000036617', 'ENSMUSG00000036712', 'ENSMUSG00000036721', 'ENSMUSG00000037188', 'ENSMUSG00000037936', 'ENSMUSG00000038079', 'ENSMUSG00000038515', 'ENSMUSG00000038733', 'ENSMUSG00000038861', 'ENSMUSG00000038970', 'ENSMUSG00000039047', 'ENSMUSG00000039478', 'ENSMUSG00000040040', 'ENSMUSG00000040594', 'ENSMUSG00000040606', 'ENSMUSG00000040618', 'ENSMUSG00000040675', 'ENSMUSG00000041058', 'ENSMUSG00000041064', 'ENSMUSG00000041164', 'ENSMUSG00000041915', 'ENSMUSG00000042121', 'ENSMUSG00000042414', 'ENSMUSG00000042548', 'ENSMUSG00000042558', 'ENSMUSG00000042684', 'ENSMUSG00000042901', 'ENSMUSG00000043004', 'ENSMUSG00000043683', 'ENSMUSG00000045136', 'ENSMUSG00000045333', 'ENSMUSG00000046079', 'ENSMUSG00000046380', 'ENSMUSG00000046572', 'ENSMUSG00000046862', 'ENSMUSG00000048402', 'ENSMUSG00000048429', 'ENSMUSG00000049489', 'ENSMUSG00000049717', 'ENSMUSG00000049916', 'ENSMUSG00000050619', 'ENSMUSG00000051285', 'ENSMUSG00000051341', 'ENSMUSG00000051379', 'ENSMUSG00000052566', 'ENSMUSG00000052712', 'ENSMUSG00000054321', 'ENSMUSG00000054519', 'ENSMUSG00000054611', 'ENSMUSG00000054648', 'ENSMUSG00000054723', 'ENSMUSG00000054945', 'ENSMUSG00000055067', 'ENSMUSG00000055102', 'ENSMUSG00000055652', 'ENSMUSG00000056019', 'ENSMUSG00000056952', 'ENSMUSG00000057342', 'ENSMUSG00000057375', 'ENSMUSG00000058192', 'ENSMUSG00000058979', 'ENSMUSG00000059475', 'ENSMUSG00000062040', 'ENSMUSG00000062101', 'ENSMUSG00000062116', 'ENSMUSG00000062901', 'ENSMUSG00000062931', 'ENSMUSG00000063320', 'ENSMUSG00000064090', 'ENSMUSG00000066151', 'ENSMUSG00000066441', 'ENSMUSG00000069184', 'ENSMUSG00000069208', 'ENSMUSG00000070426', 'ENSMUSG00000070738', 'ENSMUSG00000071281', 'ENSMUSG00000071379', 'ENSMUSG00000072066', 'ENSMUSG00000074272', 'ENSMUSG00000074305', 'ENSMUSG00000074731', 'ENSMUSG00000074890', 'ENSMUSG00000075023', 'ENSMUSG00000076431', 'ENSMUSG00000078185', 'ENSMUSG00000078497', 'ENSMUSG00000078861', 'ENSMUSG00000078872', 'ENSMUSG00000079043', 'ENSMUSG00000089857', 'ENSMUSG00000090290', 'ENSMUSG00000094786', 'ENSMUSG00000094942']


#selected_genes = ['ENSMUSG00000000078', 'ENSMUSG00000000184', 'ENSMUSG00000000194', 'ENSMUSG00000000308', 'ENSMUSG00000000325', 'ENSMUSG00000000555', 'ENSMUSG00000000711', 'ENSMUSG00000000730', 'ENSMUSG00000000804', 'ENSMUSG00000000976', 'ENSMUSG00000001082', 'ENSMUSG00000001383', 'ENSMUSG00000001518', 'ENSMUSG00000001521', 'ENSMUSG00000001891', 'ENSMUSG00000001983', 'ENSMUSG00000001998', 'ENSMUSG00000002031', 'ENSMUSG00000002257', 'ENSMUSG00000002326', 'ENSMUSG00000002342', 'ENSMUSG00000002608', 'ENSMUSG00000002660', 'ENSMUSG00000002733', 'ENSMUSG00000003033', 'ENSMUSG00000003344', 'ENSMUSG00000003363', 'ENSMUSG00000003458', 'ENSMUSG00000003573', 'ENSMUSG00000003812', 'ENSMUSG00000004018', 'ENSMUSG00000004266', 'ENSMUSG00000004558', 'ENSMUSG00000004561', 'ENSMUSG00000004565', 'ENSMUSG00000004568', 'ENSMUSG00000004665', 'ENSMUSG00000005069', 'ENSMUSG00000005470', 'ENSMUSG00000005481', 'ENSMUSG00000005621', 'ENSMUSG00000005681', 'ENSMUSG00000005886', 'ENSMUSG00000006169', 'ENSMUSG00000006276', 'ENSMUSG00000006369', 'ENSMUSG00000007029', 'ENSMUSG00000007039', 'ENSMUSG00000007721', 'ENSMUSG00000008435', 'ENSMUSG00000009566', 'ENSMUSG00000009894', 'ENSMUSG00000010110', 'ENSMUSG00000010660', 'ENSMUSG00000011306', 'ENSMUSG00000014601', 'ENSMUSG00000014763', 'ENSMUSG00000015363', 'ENSMUSG00000015568', 'ENSMUSG00000016918', 'ENSMUSG00000017288', 'ENSMUSG00000017707', 'ENSMUSG00000017837', 'ENSMUSG00000018412', 'ENSMUSG00000018796', 'ENSMUSG00000018841', 'ENSMUSG00000018846', 'ENSMUSG00000018899', 'ENSMUSG00000018931', 'ENSMUSG00000018932', 'ENSMUSG00000019467', 'ENSMUSG00000019539', 'ENSMUSG00000019731', 'ENSMUSG00000019823', 'ENSMUSG00000019841', 'ENSMUSG00000019842', 'ENSMUSG00000019845', 'ENSMUSG00000019854', 'ENSMUSG00000019907', 'ENSMUSG00000019917', 'ENSMUSG00000019920', 'ENSMUSG00000019951', 'ENSMUSG00000019975', 'ENSMUSG00000019986', 'ENSMUSG00000020020', 'ENSMUSG00000020128', 'ENSMUSG00000020134', 'ENSMUSG00000020300', 'ENSMUSG00000020362', 'ENSMUSG00000020380', 'ENSMUSG00000020407', 'ENSMUSG00000020422', 'ENSMUSG00000020440', 'ENSMUSG00000020448', 'ENSMUSG00000020453', 'ENSMUSG00000020482', 'ENSMUSG00000020521', 'ENSMUSG00000020546', 'ENSMUSG00000020766', 'ENSMUSG00000020808', 'ENSMUSG00000020817', 'ENSMUSG00000020829', 'ENSMUSG00000020840', 'ENSMUSG00000020859', 'ENSMUSG00000021007', 'ENSMUSG00000021079', 'ENSMUSG00000021156', 'ENSMUSG00000021190', 'ENSMUSG00000021235', 'ENSMUSG00000021413', 'ENSMUSG00000021417', 'ENSMUSG00000021451', 'ENSMUSG00000021494', 'ENSMUSG00000021501', 'ENSMUSG00000021532', 'ENSMUSG00000021572', 'ENSMUSG00000021578', 'ENSMUSG00000021621', 'ENSMUSG00000021690', 'ENSMUSG00000021731', 'ENSMUSG00000021754', 'ENSMUSG00000021775', 'ENSMUSG00000021785', 'ENSMUSG00000021820', 'ENSMUSG00000021948', 'ENSMUSG00000021952', 'ENSMUSG00000022089', 'ENSMUSG00000022119', 'ENSMUSG00000022159', 'ENSMUSG00000022201', 'ENSMUSG00000022214', 'ENSMUSG00000022286', 'ENSMUSG00000022299', 'ENSMUSG00000022304', 'ENSMUSG00000022337', 'ENSMUSG00000022434', 'ENSMUSG00000022519', 'ENSMUSG00000022559', 'ENSMUSG00000022574', 'ENSMUSG00000022801', 'ENSMUSG00000022837', 'ENSMUSG00000022895', 'ENSMUSG00000022897', 'ENSMUSG00000022898', 'ENSMUSG00000022900', 'ENSMUSG00000022948', 'ENSMUSG00000022999', 'ENSMUSG00000023007', 'ENSMUSG00000023026', 'ENSMUSG00000023118', 'ENSMUSG00000023243', 'ENSMUSG00000023892', 'ENSMUSG00000024030', 'ENSMUSG00000024037', 'ENSMUSG00000024039', 'ENSMUSG00000024118', 'ENSMUSG00000024260', 'ENSMUSG00000024269', 'ENSMUSG00000024293', 'ENSMUSG00000024301', 'ENSMUSG00000024376', 'ENSMUSG00000024454', 'ENSMUSG00000024507', 'ENSMUSG00000024622', 'ENSMUSG00000024666', 'ENSMUSG00000024831', 'ENSMUSG00000024855', 'ENSMUSG00000024900', 'ENSMUSG00000024947', 'ENSMUSG00000024953', 'ENSMUSG00000024981', 'ENSMUSG00000024989', 'ENSMUSG00000025006', 'ENSMUSG00000025025', 'ENSMUSG00000025077', 'ENSMUSG00000025137', 'ENSMUSG00000025161', 'ENSMUSG00000025228', 'ENSMUSG00000025354', 'ENSMUSG00000025533', 'ENSMUSG00000025545', 'ENSMUSG00000025571', 'ENSMUSG00000025579', 'ENSMUSG00000025782', 'ENSMUSG00000025812', 'ENSMUSG00000025815', 'ENSMUSG00000025894', 'ENSMUSG00000025964', 'ENSMUSG00000026003', 'ENSMUSG00000026027', 'ENSMUSG00000026036', 'ENSMUSG00000026047', 'ENSMUSG00000026080', 'ENSMUSG00000026112', 'ENSMUSG00000026135', 'ENSMUSG00000026198', 'ENSMUSG00000026199', 'ENSMUSG00000026201', 'ENSMUSG00000026213', 'ENSMUSG00000026317', 'ENSMUSG00000026342', 'ENSMUSG00000026389', 'ENSMUSG00000026492', 'ENSMUSG00000026564', 'ENSMUSG00000026584', 'ENSMUSG00000026641', 'ENSMUSG00000026705', 'ENSMUSG00000026782', 'ENSMUSG00000026784', 'ENSMUSG00000026811', 'ENSMUSG00000026857', 'ENSMUSG00000026927', 'ENSMUSG00000026955', 'ENSMUSG00000026980', 'ENSMUSG00000027222', 'ENSMUSG00000027303', 'ENSMUSG00000027333', 'ENSMUSG00000027363', 'ENSMUSG00000027384', 'ENSMUSG00000027438', 'ENSMUSG00000027465', 'ENSMUSG00000027522', 'ENSMUSG00000027540', 'ENSMUSG00000027650', 'ENSMUSG00000027742', 'ENSMUSG00000027805', 'ENSMUSG00000027865', 'ENSMUSG00000027893', 'ENSMUSG00000027932', 'ENSMUSG00000028016', 'ENSMUSG00000028063', 'ENSMUSG00000028064', 'ENSMUSG00000028126', 'ENSMUSG00000028167', 'ENSMUSG00000028329', 'ENSMUSG00000028411', 'ENSMUSG00000028479', 'ENSMUSG00000028480', 'ENSMUSG00000028488', 'ENSMUSG00000028528', 'ENSMUSG00000028581', 'ENSMUSG00000028607', 'ENSMUSG00000028681', 'ENSMUSG00000028709', 'ENSMUSG00000028710', 'ENSMUSG00000028832', 'ENSMUSG00000028850', 'ENSMUSG00000028959', 'ENSMUSG00000029125', 'ENSMUSG00000029174', 'ENSMUSG00000029186', 'ENSMUSG00000029207', 'ENSMUSG00000029229', 'ENSMUSG00000029388', 'ENSMUSG00000029433', 'ENSMUSG00000029482', 'ENSMUSG00000029599', 'ENSMUSG00000029603', 'ENSMUSG00000029636', 'ENSMUSG00000029657', 'ENSMUSG00000029752', 'ENSMUSG00000029814', 'ENSMUSG00000029998', 'ENSMUSG00000030101', 'ENSMUSG00000030103', 'ENSMUSG00000030104', 'ENSMUSG00000030161', 'ENSMUSG00000030203', 'ENSMUSG00000030231', 'ENSMUSG00000030263', 'ENSMUSG00000030284', 'ENSMUSG00000030313', 'ENSMUSG00000030322', 'ENSMUSG00000030347', 'ENSMUSG00000030374', 'ENSMUSG00000030423', 'ENSMUSG00000030469', 'ENSMUSG00000030471', 'ENSMUSG00000030556', 'ENSMUSG00000030822', 'ENSMUSG00000030861', 'ENSMUSG00000030871', 'ENSMUSG00000030888', 'ENSMUSG00000031478', 'ENSMUSG00000031482', 'ENSMUSG00000031483', 'ENSMUSG00000031487', 'ENSMUSG00000031488', 'ENSMUSG00000031516', 'ENSMUSG00000031520', 'ENSMUSG00000031521', 'ENSMUSG00000031545', 'ENSMUSG00000031548', 'ENSMUSG00000031583', 'ENSMUSG00000031600', 'ENSMUSG00000031608', 'ENSMUSG00000031631', 'ENSMUSG00000031634', 'ENSMUSG00000031644', 'ENSMUSG00000031708', 'ENSMUSG00000031729', 'ENSMUSG00000031755', 'ENSMUSG00000031758', 'ENSMUSG00000031807', 'ENSMUSG00000031823', 'ENSMUSG00000031858', 'ENSMUSG00000031862', 'ENSMUSG00000031885', 'ENSMUSG00000031903', 'ENSMUSG00000031907', 'ENSMUSG00000031930', 'ENSMUSG00000031935', 'ENSMUSG00000031959', 'ENSMUSG00000032217', 'ENSMUSG00000032220', 'ENSMUSG00000032262', 'ENSMUSG00000032291', 'ENSMUSG00000032329', 'ENSMUSG00000032350', 'ENSMUSG00000032376', 'ENSMUSG00000032405', 'ENSMUSG00000032422', 'ENSMUSG00000032449', 'ENSMUSG00000032497', 'ENSMUSG00000032513', 'ENSMUSG00000032547', 'ENSMUSG00000032553', 'ENSMUSG00000032557', 'ENSMUSG00000032586', 'ENSMUSG00000032604', 'ENSMUSG00000032688', 'ENSMUSG00000032782', 'ENSMUSG00000032796', 'ENSMUSG00000032815', 'ENSMUSG00000032883', 'ENSMUSG00000032905', 'ENSMUSG00000032997', 'ENSMUSG00000033036', 'ENSMUSG00000033068', 'ENSMUSG00000033253', 'ENSMUSG00000033382', 'ENSMUSG00000033392', 'ENSMUSG00000033581', 'ENSMUSG00000033589', 'ENSMUSG00000033669', 'ENSMUSG00000033883', 'ENSMUSG00000033952', 'ENSMUSG00000033970', 'ENSMUSG00000034105', 'ENSMUSG00000034108', 'ENSMUSG00000034189', 'ENSMUSG00000034206', 'ENSMUSG00000034210', 'ENSMUSG00000034247', 'ENSMUSG00000034327', 'ENSMUSG00000034329', 'ENSMUSG00000034342', 'ENSMUSG00000034460', 'ENSMUSG00000034636', 'ENSMUSG00000034773', 'ENSMUSG00000034781', 'ENSMUSG00000034994', 'ENSMUSG00000035000', 'ENSMUSG00000035064', 'ENSMUSG00000035142', 'ENSMUSG00000035168', 'ENSMUSG00000035236', 'ENSMUSG00000035284', 'ENSMUSG00000035293', 'ENSMUSG00000035329', 'ENSMUSG00000035376', 'ENSMUSG00000035495', 'ENSMUSG00000035671', 'ENSMUSG00000035764', 'ENSMUSG00000035824', 'ENSMUSG00000035901', 'ENSMUSG00000036026', 'ENSMUSG00000036087', 'ENSMUSG00000036275', 'ENSMUSG00000036282', 'ENSMUSG00000036291', 'ENSMUSG00000036435', 'ENSMUSG00000036503', 'ENSMUSG00000036591', 'ENSMUSG00000036613', 'ENSMUSG00000036617', 'ENSMUSG00000036712', 'ENSMUSG00000036721', 'ENSMUSG00000036779', 'ENSMUSG00000036820', 'ENSMUSG00000037134', 'ENSMUSG00000037188', 'ENSMUSG00000037214', 'ENSMUSG00000037224', 'ENSMUSG00000037730', 'ENSMUSG00000037750', 'ENSMUSG00000037816', 'ENSMUSG00000037936', 'ENSMUSG00000037992', 'ENSMUSG00000038010', 'ENSMUSG00000038079', 'ENSMUSG00000038121', 'ENSMUSG00000038172', 'ENSMUSG00000038240', 'ENSMUSG00000038250', 'ENSMUSG00000038332', 'ENSMUSG00000038459', 'ENSMUSG00000038503', 'ENSMUSG00000038515', 'ENSMUSG00000038543', 'ENSMUSG00000038733', 'ENSMUSG00000038756', 'ENSMUSG00000038759', 'ENSMUSG00000038861', 'ENSMUSG00000038963', 'ENSMUSG00000038970', 'ENSMUSG00000039047', 'ENSMUSG00000039178', 'ENSMUSG00000039246', 'ENSMUSG00000039354', 'ENSMUSG00000039431', 'ENSMUSG00000039470', 'ENSMUSG00000039478', 'ENSMUSG00000039660', 'ENSMUSG00000039662', 'ENSMUSG00000039740', 'ENSMUSG00000039748', 'ENSMUSG00000039801', 'ENSMUSG00000039834', 'ENSMUSG00000039917', 'ENSMUSG00000039958', 'ENSMUSG00000039963', 'ENSMUSG00000040040', 'ENSMUSG00000040151', 'ENSMUSG00000040220', 'ENSMUSG00000040263', 'ENSMUSG00000040511', 'ENSMUSG00000040557', 'ENSMUSG00000040562', 'ENSMUSG00000040594', 'ENSMUSG00000040606', 'ENSMUSG00000040618', 'ENSMUSG00000040675', 'ENSMUSG00000040782', 'ENSMUSG00000041058', 'ENSMUSG00000041064', 'ENSMUSG00000041112', 'ENSMUSG00000041164', 'ENSMUSG00000041426', 'ENSMUSG00000041915', 'ENSMUSG00000041921', 'ENSMUSG00000041949', 'ENSMUSG00000042010', 'ENSMUSG00000042015', 'ENSMUSG00000042121', 'ENSMUSG00000042208', 'ENSMUSG00000042414', 'ENSMUSG00000042447', 'ENSMUSG00000042548', 'ENSMUSG00000042558', 'ENSMUSG00000042684', 'ENSMUSG00000042901', 'ENSMUSG00000042992', 'ENSMUSG00000043004', 'ENSMUSG00000043019', 'ENSMUSG00000043262', 'ENSMUSG00000043683', 'ENSMUSG00000044626', 'ENSMUSG00000044807', 'ENSMUSG00000045136', 'ENSMUSG00000045252', 'ENSMUSG00000045333', 'ENSMUSG00000045752', 'ENSMUSG00000046079', 'ENSMUSG00000046204', 'ENSMUSG00000046223', 'ENSMUSG00000046230', 'ENSMUSG00000046380', 'ENSMUSG00000046572', 'ENSMUSG00000046862', 'ENSMUSG00000046909', 'ENSMUSG00000048249', 'ENSMUSG00000048327', 'ENSMUSG00000048402', 'ENSMUSG00000048429', 'ENSMUSG00000048799', 'ENSMUSG00000048878', 'ENSMUSG00000048922', 'ENSMUSG00000048960', 'ENSMUSG00000049439', 'ENSMUSG00000049489', 'ENSMUSG00000049516', 'ENSMUSG00000049717', 'ENSMUSG00000049916', 'ENSMUSG00000050188', 'ENSMUSG00000050619', 'ENSMUSG00000050846', 'ENSMUSG00000050917', 'ENSMUSG00000050953', 'ENSMUSG00000051285', 'ENSMUSG00000051306', 'ENSMUSG00000051341', 'ENSMUSG00000051379', 'ENSMUSG00000051413', 'ENSMUSG00000052566', 'ENSMUSG00000052712', 'ENSMUSG00000052752', 'ENSMUSG00000052763', 'ENSMUSG00000053091', 'ENSMUSG00000053367', 'ENSMUSG00000053870', 'ENSMUSG00000054321', 'ENSMUSG00000054400', 'ENSMUSG00000054519', 'ENSMUSG00000054611', 'ENSMUSG00000054648', 'ENSMUSG00000054715', 'ENSMUSG00000054723', 'ENSMUSG00000054945', 'ENSMUSG00000055065', 'ENSMUSG00000055067', 'ENSMUSG00000055102', 'ENSMUSG00000055652', 'ENSMUSG00000055670', 'ENSMUSG00000055932', 'ENSMUSG00000056019', 'ENSMUSG00000056204', 'ENSMUSG00000056234', 'ENSMUSG00000056486', 'ENSMUSG00000056515', 'ENSMUSG00000056941', 'ENSMUSG00000056952', 'ENSMUSG00000057101', 'ENSMUSG00000057133', 'ENSMUSG00000057134', 'ENSMUSG00000057342', 'ENSMUSG00000057375', 'ENSMUSG00000058056', 'ENSMUSG00000058192', 'ENSMUSG00000058240', 'ENSMUSG00000058587', 'ENSMUSG00000058672', 'ENSMUSG00000058979', 'ENSMUSG00000059423', 'ENSMUSG00000059475', 'ENSMUSG00000059791', 'ENSMUSG00000059834', 'ENSMUSG00000060032', 'ENSMUSG00000060679', 'ENSMUSG00000061371', 'ENSMUSG00000061731', 'ENSMUSG00000062040', 'ENSMUSG00000062101', 'ENSMUSG00000062116', 'ENSMUSG00000062901', 'ENSMUSG00000062931', 'ENSMUSG00000062939', 'ENSMUSG00000062995', 'ENSMUSG00000063320', 'ENSMUSG00000063810', 'ENSMUSG00000063972', 'ENSMUSG00000064090', 'ENSMUSG00000064105', 'ENSMUSG00000065999', 'ENSMUSG00000066151', 'ENSMUSG00000066152', 'ENSMUSG00000066441', 'ENSMUSG00000067430', 'ENSMUSG00000067702', 'ENSMUSG00000067713', 'ENSMUSG00000068134', 'ENSMUSG00000069184', 'ENSMUSG00000069208', 'ENSMUSG00000070047', 'ENSMUSG00000070426', 'ENSMUSG00000070738', 'ENSMUSG00000071281', 'ENSMUSG00000071379', 'ENSMUSG00000072066', 'ENSMUSG00000072694', 'ENSMUSG00000073792', 'ENSMUSG00000074272', 'ENSMUSG00000074305', 'ENSMUSG00000074731', 'ENSMUSG00000074748', 'ENSMUSG00000074749', 'ENSMUSG00000074832', 'ENSMUSG00000074890', 'ENSMUSG00000075023', 'ENSMUSG00000076431', 'ENSMUSG00000078185', 'ENSMUSG00000078497', 'ENSMUSG00000078689', 'ENSMUSG00000078861', 'ENSMUSG00000078872', 'ENSMUSG00000078941', 'ENSMUSG00000079036', 'ENSMUSG00000079042', 'ENSMUSG00000079043', 'ENSMUSG00000087651', 'ENSMUSG00000089857', 'ENSMUSG00000090290', 'ENSMUSG00000094786', 'ENSMUSG00000094942', 'ENSMUSG00000099083', 'ENSMUSG00000107023', 'ENSMUSG00000109398', 'ENSMUSG00000109771']

# all genes
selected_genes = ['ENSMUSG00000000184', 'ENSMUSG00000000194', 'ENSMUSG00000000278', 'ENSMUSG00000000325', 'ENSMUSG00000000441', 'ENSMUSG00000000563', 'ENSMUSG00000000579', 'ENSMUSG00000000581', 'ENSMUSG00000000730', 'ENSMUSG00000000740', 'ENSMUSG00000000751', 'ENSMUSG00000000782', 'ENSMUSG00000000884', 'ENSMUSG00000000976', 'ENSMUSG00000001016', 'ENSMUSG00000001017', 'ENSMUSG00000001039', 'ENSMUSG00000001158', 'ENSMUSG00000001270', 'ENSMUSG00000001416', 'ENSMUSG00000001441', 'ENSMUSG00000001552', 'ENSMUSG00000001632', 'ENSMUSG00000001707', 'ENSMUSG00000001785', 'ENSMUSG00000001983', 'ENSMUSG00000001999', 'ENSMUSG00000002059', 'ENSMUSG00000002129', 'ENSMUSG00000002257', 'ENSMUSG00000002265', 'ENSMUSG00000002326', 'ENSMUSG00000002342', 'ENSMUSG00000002345', 'ENSMUSG00000002679', 'ENSMUSG00000002733', 'ENSMUSG00000002844', 'ENSMUSG00000002948', 'ENSMUSG00000002985', 'ENSMUSG00000003033', 'ENSMUSG00000003068', 'ENSMUSG00000003199', 'ENSMUSG00000003316', 'ENSMUSG00000003345', 'ENSMUSG00000003680', 'ENSMUSG00000003721', 'ENSMUSG00000003847', 'ENSMUSG00000004266', 'ENSMUSG00000004268', 'ENSMUSG00000004270', 'ENSMUSG00000004319', 'ENSMUSG00000004455', 'ENSMUSG00000004535', 'ENSMUSG00000004558', 'ENSMUSG00000004996', 'ENSMUSG00000005069', 'ENSMUSG00000005148', 'ENSMUSG00000005225', 'ENSMUSG00000005233', 'ENSMUSG00000005312', 'ENSMUSG00000005410', 'ENSMUSG00000005413', 'ENSMUSG00000005566', 'ENSMUSG00000005621', 'ENSMUSG00000005656', 'ENSMUSG00000005672', 'ENSMUSG00000005899', 'ENSMUSG00000005981', 'ENSMUSG00000006056', 'ENSMUSG00000006095', 'ENSMUSG00000006169', 'ENSMUSG00000006276', 'ENSMUSG00000006304', 'ENSMUSG00000006333', 'ENSMUSG00000006369', 'ENSMUSG00000006517', 'ENSMUSG00000006526', 'ENSMUSG00000006599', 'ENSMUSG00000006649', 'ENSMUSG00000007338', 'ENSMUSG00000007458', 'ENSMUSG00000007670', 'ENSMUSG00000007721', 'ENSMUSG00000007827', 'ENSMUSG00000007833', 'ENSMUSG00000007892', 'ENSMUSG00000008384', 'ENSMUSG00000008435', 'ENSMUSG00000008475', 'ENSMUSG00000008668', 'ENSMUSG00000008892', 'ENSMUSG00000009013', 'ENSMUSG00000009073', 'ENSMUSG00000009112', 'ENSMUSG00000009894', 'ENSMUSG00000010290', 'ENSMUSG00000010406', 'ENSMUSG00000010554', 'ENSMUSG00000011179', 'ENSMUSG00000011837', 'ENSMUSG00000012396', 'ENSMUSG00000012429', 'ENSMUSG00000012848', 'ENSMUSG00000013663', 'ENSMUSG00000013701', 'ENSMUSG00000013766', 'ENSMUSG00000013822', 'ENSMUSG00000014077', 'ENSMUSG00000014907', 'ENSMUSG00000014956', 'ENSMUSG00000015120', 'ENSMUSG00000015143', 'ENSMUSG00000015165', 'ENSMUSG00000015341', 'ENSMUSG00000015568', 'ENSMUSG00000015804', 'ENSMUSG00000016252', 'ENSMUSG00000016487', 'ENSMUSG00000016526', 'ENSMUSG00000016541', 'ENSMUSG00000016833', 'ENSMUSG00000016921', 'ENSMUSG00000016946', 'ENSMUSG00000017221', 'ENSMUSG00000017428', 'ENSMUSG00000017478', 'ENSMUSG00000017548', 'ENSMUSG00000017724', 'ENSMUSG00000017837', 'ENSMUSG00000017843', 'ENSMUSG00000017861', 'ENSMUSG00000018040', 'ENSMUSG00000018042', 'ENSMUSG00000018166', 'ENSMUSG00000018286', 'ENSMUSG00000018326', 'ENSMUSG00000018379', 'ENSMUSG00000018398', 'ENSMUSG00000018412', 'ENSMUSG00000018433', 'ENSMUSG00000018449', 'ENSMUSG00000018697', 'ENSMUSG00000018770', 'ENSMUSG00000018841', 'ENSMUSG00000018848', 'ENSMUSG00000019210', 'ENSMUSG00000019362', 'ENSMUSG00000019370', 'ENSMUSG00000019432', 'ENSMUSG00000019471', 'ENSMUSG00000019494', 'ENSMUSG00000019505', 'ENSMUSG00000019528', 'ENSMUSG00000019710', 'ENSMUSG00000019837', 'ENSMUSG00000019841', 'ENSMUSG00000019842', 'ENSMUSG00000019845', 'ENSMUSG00000019849', 'ENSMUSG00000019854', 'ENSMUSG00000019864', 'ENSMUSG00000019907', 'ENSMUSG00000019917', 'ENSMUSG00000019920', 'ENSMUSG00000019966', 'ENSMUSG00000019970', 'ENSMUSG00000019978', 'ENSMUSG00000020075', 'ENSMUSG00000020097', 'ENSMUSG00000020116', 'ENSMUSG00000020130', 'ENSMUSG00000020271', 'ENSMUSG00000020290', 'ENSMUSG00000020300', 'ENSMUSG00000020315', 'ENSMUSG00000020321', 'ENSMUSG00000020330', 'ENSMUSG00000020362', 'ENSMUSG00000020372', 'ENSMUSG00000020392', 'ENSMUSG00000020402', 'ENSMUSG00000020415', 'ENSMUSG00000020422', 'ENSMUSG00000020424', 'ENSMUSG00000020444', 'ENSMUSG00000020448', 'ENSMUSG00000020455', 'ENSMUSG00000020472', 'ENSMUSG00000020521', 'ENSMUSG00000020528', 'ENSMUSG00000020544', 'ENSMUSG00000020570', 'ENSMUSG00000020594', 'ENSMUSG00000020629', 'ENSMUSG00000020644', 'ENSMUSG00000020648', 'ENSMUSG00000020650', 'ENSMUSG00000020739', 'ENSMUSG00000020740', 'ENSMUSG00000020741', 'ENSMUSG00000020766', 'ENSMUSG00000020803', 'ENSMUSG00000020808', 'ENSMUSG00000020859', 'ENSMUSG00000020863', 'ENSMUSG00000020910', 'ENSMUSG00000020925', 'ENSMUSG00000020929', 'ENSMUSG00000020946', 'ENSMUSG00000020949', 'ENSMUSG00000020994', 'ENSMUSG00000021037', 'ENSMUSG00000021111', 'ENSMUSG00000021114', 'ENSMUSG00000021193', 'ENSMUSG00000021218', 'ENSMUSG00000021235', 'ENSMUSG00000021243', 'ENSMUSG00000021264', 'ENSMUSG00000021266', 'ENSMUSG00000021276', 'ENSMUSG00000021290', 'ENSMUSG00000021306', 'ENSMUSG00000021311', 'ENSMUSG00000021357', 'ENSMUSG00000021395', 'ENSMUSG00000021413', 'ENSMUSG00000021427', 'ENSMUSG00000021428', 'ENSMUSG00000021451', 'ENSMUSG00000021474', 'ENSMUSG00000021481', 'ENSMUSG00000021500', 'ENSMUSG00000021532', 'ENSMUSG00000021548', 'ENSMUSG00000021576', 'ENSMUSG00000021591', 'ENSMUSG00000021621', 'ENSMUSG00000021660', 'ENSMUSG00000021707', 'ENSMUSG00000021775', 'ENSMUSG00000021796', 'ENSMUSG00000021806', 'ENSMUSG00000021807', 'ENSMUSG00000021843', 'ENSMUSG00000021868', 'ENSMUSG00000021901', 'ENSMUSG00000021902', 'ENSMUSG00000021908', 'ENSMUSG00000021910', 'ENSMUSG00000021932', 'ENSMUSG00000022000', 'ENSMUSG00000022010', 'ENSMUSG00000022034', 'ENSMUSG00000022051', 'ENSMUSG00000022074', 'ENSMUSG00000022108', 'ENSMUSG00000022159', 'ENSMUSG00000022177', 'ENSMUSG00000022200', 'ENSMUSG00000022205', 'ENSMUSG00000022216', 'ENSMUSG00000022241', 'ENSMUSG00000022253', 'ENSMUSG00000022304', 'ENSMUSG00000022337', 'ENSMUSG00000022391', 'ENSMUSG00000022407', 'ENSMUSG00000022452', 'ENSMUSG00000022474', 'ENSMUSG00000022503', 'ENSMUSG00000022548', 'ENSMUSG00000022559', 'ENSMUSG00000022574', 'ENSMUSG00000022635', 'ENSMUSG00000022652', 'ENSMUSG00000022673', 'ENSMUSG00000022674', 'ENSMUSG00000022682', 'ENSMUSG00000022683', 'ENSMUSG00000022685', 'ENSMUSG00000022704', 'ENSMUSG00000022771', 'ENSMUSG00000022808', 'ENSMUSG00000022820', 'ENSMUSG00000022833', 'ENSMUSG00000022849', 'ENSMUSG00000022890', 'ENSMUSG00000022897', 'ENSMUSG00000022905', 'ENSMUSG00000022948', 'ENSMUSG00000022992', 'ENSMUSG00000023004', 'ENSMUSG00000023025', 'ENSMUSG00000023026', 'ENSMUSG00000023067', 'ENSMUSG00000023075', 'ENSMUSG00000023079', 'ENSMUSG00000023087', 'ENSMUSG00000023106', 'ENSMUSG00000023110', 'ENSMUSG00000023118', 'ENSMUSG00000023307', 'ENSMUSG00000023452', 'ENSMUSG00000023755', 'ENSMUSG00000023764', 'ENSMUSG00000023892', 'ENSMUSG00000023932', 'ENSMUSG00000023938', 'ENSMUSG00000023939', 'ENSMUSG00000023980', 'ENSMUSG00000024026', 'ENSMUSG00000024037', 'ENSMUSG00000024048', 'ENSMUSG00000024056', 'ENSMUSG00000024096', 'ENSMUSG00000024098', 'ENSMUSG00000024104', 'ENSMUSG00000024145', 'ENSMUSG00000024151', 'ENSMUSG00000024217', 'ENSMUSG00000024218', 'ENSMUSG00000024260', 'ENSMUSG00000024269', 'ENSMUSG00000024277', 'ENSMUSG00000024293', 'ENSMUSG00000024301', 'ENSMUSG00000024317', 'ENSMUSG00000024319', 'ENSMUSG00000024327', 'ENSMUSG00000024378', 'ENSMUSG00000024382', 'ENSMUSG00000024422', 'ENSMUSG00000024425', 'ENSMUSG00000024446', 'ENSMUSG00000024454', 'ENSMUSG00000024472', 'ENSMUSG00000024491', 'ENSMUSG00000024525', 'ENSMUSG00000024579', 'ENSMUSG00000024590', 'ENSMUSG00000024601', 'ENSMUSG00000024622', 'ENSMUSG00000024640', 'ENSMUSG00000024644', 'ENSMUSG00000024646', 'ENSMUSG00000024661', 'ENSMUSG00000024807', 'ENSMUSG00000024811', 'ENSMUSG00000024843', 'ENSMUSG00000025006', 'ENSMUSG00000025019', 'ENSMUSG00000025066', 'ENSMUSG00000025077', 'ENSMUSG00000025086', 'ENSMUSG00000025102', 'ENSMUSG00000025137', 'ENSMUSG00000025144', 'ENSMUSG00000025153', 'ENSMUSG00000025154', 'ENSMUSG00000025239', 'ENSMUSG00000025290', 'ENSMUSG00000025326', 'ENSMUSG00000025351', 'ENSMUSG00000025354', 'ENSMUSG00000025423', 'ENSMUSG00000025474', 'ENSMUSG00000025495', 'ENSMUSG00000025533', 'ENSMUSG00000025544', 'ENSMUSG00000025591', 'ENSMUSG00000025651', 'ENSMUSG00000025762', 'ENSMUSG00000025764', 'ENSMUSG00000025815', 'ENSMUSG00000025825', 'ENSMUSG00000025925', 'ENSMUSG00000025940', 'ENSMUSG00000025950', 'ENSMUSG00000025956', 'ENSMUSG00000025962', 'ENSMUSG00000025986', 'ENSMUSG00000026000', 'ENSMUSG00000026003', 'ENSMUSG00000026021', 'ENSMUSG00000026027', 'ENSMUSG00000026036', 'ENSMUSG00000026039', 'ENSMUSG00000026048', 'ENSMUSG00000026049', 'ENSMUSG00000026074', 'ENSMUSG00000026078', 'ENSMUSG00000026198', 'ENSMUSG00000026199', 'ENSMUSG00000026201', 'ENSMUSG00000026238', 'ENSMUSG00000026260', 'ENSMUSG00000026317', 'ENSMUSG00000026342', 'ENSMUSG00000026434', 'ENSMUSG00000026584', 'ENSMUSG00000026596', 'ENSMUSG00000026623', 'ENSMUSG00000026643', 'ENSMUSG00000026705', 'ENSMUSG00000026784', 'ENSMUSG00000026788', 'ENSMUSG00000026810', 'ENSMUSG00000026820', 'ENSMUSG00000026895', 'ENSMUSG00000026918', 'ENSMUSG00000026924', 'ENSMUSG00000026927', 'ENSMUSG00000026955', 'ENSMUSG00000026958', 'ENSMUSG00000027006', 'ENSMUSG00000027067', 'ENSMUSG00000027109', 'ENSMUSG00000027131', 'ENSMUSG00000027162', 'ENSMUSG00000027166', 'ENSMUSG00000027170', 'ENSMUSG00000027187', 'ENSMUSG00000027193', 'ENSMUSG00000027195', 'ENSMUSG00000027201', 'ENSMUSG00000027288', 'ENSMUSG00000027303', 'ENSMUSG00000027387', 'ENSMUSG00000027424', 'ENSMUSG00000027438', 'ENSMUSG00000027447', 'ENSMUSG00000027466', 'ENSMUSG00000027469', 'ENSMUSG00000027487', 'ENSMUSG00000027573', 'ENSMUSG00000027599', 'ENSMUSG00000027601', 'ENSMUSG00000027613', 'ENSMUSG00000027637', 'ENSMUSG00000027642', 'ENSMUSG00000027649', 'ENSMUSG00000027667', 'ENSMUSG00000027706', 'ENSMUSG00000027714', 'ENSMUSG00000027774', 'ENSMUSG00000027794', 'ENSMUSG00000027804', 'ENSMUSG00000027805', 'ENSMUSG00000027881', 'ENSMUSG00000027968', 'ENSMUSG00000028013', 'ENSMUSG00000028062', 'ENSMUSG00000028081', 'ENSMUSG00000028114', 'ENSMUSG00000028126', 'ENSMUSG00000028156', 'ENSMUSG00000028164', 'ENSMUSG00000028191', 'ENSMUSG00000028212', 'ENSMUSG00000028247', 'ENSMUSG00000028261', 'ENSMUSG00000028282', 'ENSMUSG00000028292', 'ENSMUSG00000028318', 'ENSMUSG00000028383', 'ENSMUSG00000028385', 'ENSMUSG00000028393', 'ENSMUSG00000028403', 'ENSMUSG00000028410', 'ENSMUSG00000028426', 'ENSMUSG00000028433', 'ENSMUSG00000028470', 'ENSMUSG00000028479', 'ENSMUSG00000028488', 'ENSMUSG00000028495', 'ENSMUSG00000028528', 'ENSMUSG00000028530', 'ENSMUSG00000028552', 'ENSMUSG00000028581', 'ENSMUSG00000028607', 'ENSMUSG00000028636', 'ENSMUSG00000028640', 'ENSMUSG00000028648', 'ENSMUSG00000028651', 'ENSMUSG00000028676', 'ENSMUSG00000028683', 'ENSMUSG00000028691', 'ENSMUSG00000028692', 'ENSMUSG00000028702', 'ENSMUSG00000028709', 'ENSMUSG00000028710', 'ENSMUSG00000028729', 'ENSMUSG00000028788', 'ENSMUSG00000028792', 'ENSMUSG00000028850', 'ENSMUSG00000028851', 'ENSMUSG00000028861', 'ENSMUSG00000028878', 'ENSMUSG00000028884', 'ENSMUSG00000028898', 'ENSMUSG00000028901', 'ENSMUSG00000028920', 'ENSMUSG00000028936', 'ENSMUSG00000028937', 'ENSMUSG00000028945', 'ENSMUSG00000028960', 'ENSMUSG00000028961', 'ENSMUSG00000028967', 'ENSMUSG00000028970', 'ENSMUSG00000028998', 'ENSMUSG00000029007', 'ENSMUSG00000029020', 'ENSMUSG00000029062', 'ENSMUSG00000029066', 'ENSMUSG00000029104', 'ENSMUSG00000029110', 'ENSMUSG00000029191', 'ENSMUSG00000029203', 'ENSMUSG00000029205', 'ENSMUSG00000029249', 'ENSMUSG00000029290', 'ENSMUSG00000029304', 'ENSMUSG00000029328', 'ENSMUSG00000029363', 'ENSMUSG00000029390', 'ENSMUSG00000029405', 'ENSMUSG00000029407', 'ENSMUSG00000029415', 'ENSMUSG00000029430', 'ENSMUSG00000029465', 'ENSMUSG00000029467', 'ENSMUSG00000029482', 'ENSMUSG00000029538', 'ENSMUSG00000029581', 'ENSMUSG00000029610', 'ENSMUSG00000029632', 'ENSMUSG00000029649', 'ENSMUSG00000029767', 'ENSMUSG00000029777', 'ENSMUSG00000029802', 'ENSMUSG00000029910', 'ENSMUSG00000029918', 'ENSMUSG00000030042', 'ENSMUSG00000030058', 'ENSMUSG00000030060', 'ENSMUSG00000030067', 'ENSMUSG00000030082', 'ENSMUSG00000030101', 'ENSMUSG00000030102', 'ENSMUSG00000030104', 'ENSMUSG00000030105', 'ENSMUSG00000030116', 'ENSMUSG00000030120', 'ENSMUSG00000030126', 'ENSMUSG00000030127', 'ENSMUSG00000030145', 'ENSMUSG00000030168', 'ENSMUSG00000030180', 'ENSMUSG00000030204', 'ENSMUSG00000030216', 'ENSMUSG00000030224', 'ENSMUSG00000030232', 'ENSMUSG00000030243', 'ENSMUSG00000030245', 'ENSMUSG00000030254', 'ENSMUSG00000030263', 'ENSMUSG00000030264', 'ENSMUSG00000030268', 'ENSMUSG00000030269', 'ENSMUSG00000030275', 'ENSMUSG00000030286', 'ENSMUSG00000030313', 'ENSMUSG00000030316', 'ENSMUSG00000030319', 'ENSMUSG00000030327', 'ENSMUSG00000030330', 'ENSMUSG00000030342', 'ENSMUSG00000030347', 'ENSMUSG00000030357', 'ENSMUSG00000030374', 'ENSMUSG00000030423', 'ENSMUSG00000030432', 'ENSMUSG00000030512', 'ENSMUSG00000030605', 'ENSMUSG00000030612', 'ENSMUSG00000030619', 'ENSMUSG00000030647', 'ENSMUSG00000030649', 'ENSMUSG00000030654', 'ENSMUSG00000030697', 'ENSMUSG00000030704', 'ENSMUSG00000030722', 'ENSMUSG00000030726', 'ENSMUSG00000030741', 'ENSMUSG00000030750', 'ENSMUSG00000030842', 'ENSMUSG00000030861', 'ENSMUSG00000031078', 'ENSMUSG00000031447', 'ENSMUSG00000031458', 'ENSMUSG00000031467', 'ENSMUSG00000031478', 'ENSMUSG00000031479', 'ENSMUSG00000031485', 'ENSMUSG00000031487', 'ENSMUSG00000031490', 'ENSMUSG00000031516', 'ENSMUSG00000031527', 'ENSMUSG00000031533', 'ENSMUSG00000031540', 'ENSMUSG00000031546', 'ENSMUSG00000031548', 'ENSMUSG00000031556', 'ENSMUSG00000031563', 'ENSMUSG00000031565', 'ENSMUSG00000031578', 'ENSMUSG00000031585', 'ENSMUSG00000031586', 'ENSMUSG00000031590', 'ENSMUSG00000031591', 'ENSMUSG00000031592', 'ENSMUSG00000031600', 'ENSMUSG00000031608', 'ENSMUSG00000031609', 'ENSMUSG00000031622', 'ENSMUSG00000031633', 'ENSMUSG00000031652', 'ENSMUSG00000031657', 'ENSMUSG00000031660', 'ENSMUSG00000031665', 'ENSMUSG00000031667', 'ENSMUSG00000031671', 'ENSMUSG00000031672', 'ENSMUSG00000031683', 'ENSMUSG00000031696', 'ENSMUSG00000031697', 'ENSMUSG00000031715', 'ENSMUSG00000031723', 'ENSMUSG00000031754', 'ENSMUSG00000031756', 'ENSMUSG00000031758', 'ENSMUSG00000031781', 'ENSMUSG00000031783', 'ENSMUSG00000031796', 'ENSMUSG00000031819', 'ENSMUSG00000031827', 'ENSMUSG00000031838', 'ENSMUSG00000031851', 'ENSMUSG00000031864', 'ENSMUSG00000031878', 'ENSMUSG00000031902', 'ENSMUSG00000031904', 'ENSMUSG00000031907', 'ENSMUSG00000031924', 'ENSMUSG00000031931', 'ENSMUSG00000031934', 'ENSMUSG00000031935', 'ENSMUSG00000031939', 'ENSMUSG00000031948', 'ENSMUSG00000031949', 'ENSMUSG00000031950', 'ENSMUSG00000031951', 'ENSMUSG00000031954', 'ENSMUSG00000031955', 'ENSMUSG00000031959', 'ENSMUSG00000031974', 'ENSMUSG00000031988', 'ENSMUSG00000032050', 'ENSMUSG00000032096', 'ENSMUSG00000032220', 'ENSMUSG00000032239', 'ENSMUSG00000032262', 'ENSMUSG00000032264', 'ENSMUSG00000032279', 'ENSMUSG00000032288', 'ENSMUSG00000032300', 'ENSMUSG00000032350', 'ENSMUSG00000032366', 'ENSMUSG00000032374', 'ENSMUSG00000032396', 'ENSMUSG00000032422', 'ENSMUSG00000032459', 'ENSMUSG00000032479', 'ENSMUSG00000032497', 'ENSMUSG00000032513', 'ENSMUSG00000032518', 'ENSMUSG00000032526', 'ENSMUSG00000032534', 'ENSMUSG00000032547', 'ENSMUSG00000032577', 'ENSMUSG00000032601', 'ENSMUSG00000032624', 'ENSMUSG00000032688', 'ENSMUSG00000032712', 'ENSMUSG00000032715', 'ENSMUSG00000032782', 'ENSMUSG00000032815', 'ENSMUSG00000032897', 'ENSMUSG00000033020', 'ENSMUSG00000033075', 'ENSMUSG00000033105', 'ENSMUSG00000033186', 'ENSMUSG00000033253', 'ENSMUSG00000033294', 'ENSMUSG00000033423', 'ENSMUSG00000033499', 'ENSMUSG00000033554', 'ENSMUSG00000033557', 'ENSMUSG00000033623', 'ENSMUSG00000033669', 'ENSMUSG00000033701', 'ENSMUSG00000033712', 'ENSMUSG00000033751', 'ENSMUSG00000033790', 'ENSMUSG00000033793', 'ENSMUSG00000033845', 'ENSMUSG00000033916', 'ENSMUSG00000033931', 'ENSMUSG00000033938', 'ENSMUSG00000033940', 'ENSMUSG00000033953', 'ENSMUSG00000033991', 'ENSMUSG00000033998', 'ENSMUSG00000034105', 'ENSMUSG00000034108', 'ENSMUSG00000034121', 'ENSMUSG00000034152', 'ENSMUSG00000034154', 'ENSMUSG00000034247', 'ENSMUSG00000034285', 'ENSMUSG00000034329', 'ENSMUSG00000034345', 'ENSMUSG00000034424', 'ENSMUSG00000034460', 'ENSMUSG00000034574', 'ENSMUSG00000034617', 'ENSMUSG00000034620', 'ENSMUSG00000034636', 'ENSMUSG00000034681', 'ENSMUSG00000034757', 'ENSMUSG00000034773', 'ENSMUSG00000034781', 'ENSMUSG00000034867', 'ENSMUSG00000034868', 'ENSMUSG00000034880', 'ENSMUSG00000035048', 'ENSMUSG00000035064', 'ENSMUSG00000035093', 'ENSMUSG00000035151', 'ENSMUSG00000035247', 'ENSMUSG00000035329', 'ENSMUSG00000035372', 'ENSMUSG00000035443', 'ENSMUSG00000035530', 'ENSMUSG00000035569', 'ENSMUSG00000035575', 'ENSMUSG00000035578', 'ENSMUSG00000035585', 'ENSMUSG00000035671', 'ENSMUSG00000035824', 'ENSMUSG00000035885', 'ENSMUSG00000035960', 'ENSMUSG00000035992', 'ENSMUSG00000036087', 'ENSMUSG00000036097', 'ENSMUSG00000036112', 'ENSMUSG00000036138', 'ENSMUSG00000036188', 'ENSMUSG00000036199', 'ENSMUSG00000036275', 'ENSMUSG00000036282', 'ENSMUSG00000036291', 'ENSMUSG00000036371', 'ENSMUSG00000036435', 'ENSMUSG00000036534', 'ENSMUSG00000036591', 'ENSMUSG00000036617', 'ENSMUSG00000036672', 'ENSMUSG00000036712', 'ENSMUSG00000036721', 'ENSMUSG00000036777', 'ENSMUSG00000036781', 'ENSMUSG00000037017', 'ENSMUSG00000037070', 'ENSMUSG00000037108', 'ENSMUSG00000037152', 'ENSMUSG00000037188', 'ENSMUSG00000037257', 'ENSMUSG00000037364', 'ENSMUSG00000037373', 'ENSMUSG00000037395', 'ENSMUSG00000037405', 'ENSMUSG00000037426', 'ENSMUSG00000037499', 'ENSMUSG00000037519', 'ENSMUSG00000037526', 'ENSMUSG00000037544', 'ENSMUSG00000037608', 'ENSMUSG00000037640', 'ENSMUSG00000037656', 'ENSMUSG00000037706', 'ENSMUSG00000037725', 'ENSMUSG00000037740', 'ENSMUSG00000037742', 'ENSMUSG00000037808', 'ENSMUSG00000037885', 'ENSMUSG00000037916', 'ENSMUSG00000037936', 'ENSMUSG00000037958', 'ENSMUSG00000037993', 'ENSMUSG00000038007', 'ENSMUSG00000038013', 'ENSMUSG00000038014', 'ENSMUSG00000038028', 'ENSMUSG00000038034', 'ENSMUSG00000038045', 'ENSMUSG00000038069', 'ENSMUSG00000038079', 'ENSMUSG00000038102', 'ENSMUSG00000038205', 'ENSMUSG00000038215', 'ENSMUSG00000038235', 'ENSMUSG00000038279', 'ENSMUSG00000038384', 'ENSMUSG00000038398', 'ENSMUSG00000038412', 'ENSMUSG00000038418', 'ENSMUSG00000038467', 'ENSMUSG00000038482', 'ENSMUSG00000038500', 'ENSMUSG00000038515', 'ENSMUSG00000038525', 'ENSMUSG00000038535', 'ENSMUSG00000038563', 'ENSMUSG00000038646', 'ENSMUSG00000038683', 'ENSMUSG00000038717', 'ENSMUSG00000038733', 'ENSMUSG00000038766', 'ENSMUSG00000038773', 'ENSMUSG00000038793', 'ENSMUSG00000038861', 'ENSMUSG00000038970', 'ENSMUSG00000038982', 'ENSMUSG00000039047', 'ENSMUSG00000039055', 'ENSMUSG00000039067', 'ENSMUSG00000039105', 'ENSMUSG00000039126', 'ENSMUSG00000039176', 'ENSMUSG00000039224', 'ENSMUSG00000039230', 'ENSMUSG00000039298', 'ENSMUSG00000039323', 'ENSMUSG00000039347', 'ENSMUSG00000039395', 'ENSMUSG00000039478', 'ENSMUSG00000039509', 'ENSMUSG00000039512', 'ENSMUSG00000039530', 'ENSMUSG00000039678', 'ENSMUSG00000039682', 'ENSMUSG00000039725', 'ENSMUSG00000039737', 'ENSMUSG00000039826', 'ENSMUSG00000039852', 'ENSMUSG00000039959', 'ENSMUSG00000039988', 'ENSMUSG00000040025', 'ENSMUSG00000040028', 'ENSMUSG00000040029', 'ENSMUSG00000040040', 'ENSMUSG00000040102', 'ENSMUSG00000040183', 'ENSMUSG00000040225', 'ENSMUSG00000040236', 'ENSMUSG00000040331', 'ENSMUSG00000040532', 'ENSMUSG00000040594', 'ENSMUSG00000040606', 'ENSMUSG00000040618', 'ENSMUSG00000040640', 'ENSMUSG00000040652', 'ENSMUSG00000040669', 'ENSMUSG00000040675', 'ENSMUSG00000041058', 'ENSMUSG00000041064', 'ENSMUSG00000041147', 'ENSMUSG00000041164', 'ENSMUSG00000041215', 'ENSMUSG00000041236', 'ENSMUSG00000041264', 'ENSMUSG00000041268', 'ENSMUSG00000041278', 'ENSMUSG00000041406', 'ENSMUSG00000041471', 'ENSMUSG00000041498', 'ENSMUSG00000041560', 'ENSMUSG00000041629', 'ENSMUSG00000041671', 'ENSMUSG00000041747', 'ENSMUSG00000041840', 'ENSMUSG00000041841', 'ENSMUSG00000041891', 'ENSMUSG00000041915', 'ENSMUSG00000041975', 'ENSMUSG00000042055', 'ENSMUSG00000042079', 'ENSMUSG00000042099', 'ENSMUSG00000042111', 'ENSMUSG00000042121', 'ENSMUSG00000042185', 'ENSMUSG00000042211', 'ENSMUSG00000042357', 'ENSMUSG00000042389', 'ENSMUSG00000042390', 'ENSMUSG00000042414', 'ENSMUSG00000042472', 'ENSMUSG00000042541', 'ENSMUSG00000042548', 'ENSMUSG00000042558', 'ENSMUSG00000042625', 'ENSMUSG00000042684', 'ENSMUSG00000042709', 'ENSMUSG00000042870', 'ENSMUSG00000042901', 'ENSMUSG00000043004', 'ENSMUSG00000043015', 'ENSMUSG00000043061', 'ENSMUSG00000043183', 'ENSMUSG00000043241', 'ENSMUSG00000043252', 'ENSMUSG00000043323', 'ENSMUSG00000043445', 'ENSMUSG00000043510', 'ENSMUSG00000043535', 'ENSMUSG00000043683', 'ENSMUSG00000044147', 'ENSMUSG00000044201', 'ENSMUSG00000044393', 'ENSMUSG00000044502', 'ENSMUSG00000044533', 'ENSMUSG00000044573', 'ENSMUSG00000044783', 'ENSMUSG00000044792', 'ENSMUSG00000044934', 'ENSMUSG00000044986', 'ENSMUSG00000045128', 'ENSMUSG00000045136', 'ENSMUSG00000045248', 'ENSMUSG00000045294', 'ENSMUSG00000045333', 'ENSMUSG00000045410', 'ENSMUSG00000045594', 'ENSMUSG00000045667', 'ENSMUSG00000045671', 'ENSMUSG00000045699', 'ENSMUSG00000045767', 'ENSMUSG00000045973', 'ENSMUSG00000046062', 'ENSMUSG00000046079', 'ENSMUSG00000046139', 'ENSMUSG00000046201', 'ENSMUSG00000046311', 'ENSMUSG00000046380', 'ENSMUSG00000046572', 'ENSMUSG00000046679', 'ENSMUSG00000046691', 'ENSMUSG00000046707', 'ENSMUSG00000046841', 'ENSMUSG00000046862', 'ENSMUSG00000046962', 'ENSMUSG00000047193', 'ENSMUSG00000047221', 'ENSMUSG00000047407', 'ENSMUSG00000047412', 'ENSMUSG00000048351', 'ENSMUSG00000048402', 'ENSMUSG00000048429', 'ENSMUSG00000048486', 'ENSMUSG00000048756', 'ENSMUSG00000048787', 'ENSMUSG00000048930', 'ENSMUSG00000049076', 'ENSMUSG00000049091', 'ENSMUSG00000049233', 'ENSMUSG00000049489', 'ENSMUSG00000049717', 'ENSMUSG00000049882', 'ENSMUSG00000049916', 'ENSMUSG00000050122', 'ENSMUSG00000050192', 'ENSMUSG00000050240', 'ENSMUSG00000050619', 'ENSMUSG00000050697', 'ENSMUSG00000050856', 'ENSMUSG00000051176', 'ENSMUSG00000051285', 'ENSMUSG00000051341', 'ENSMUSG00000051355', 'ENSMUSG00000051379', 'ENSMUSG00000051671', 'ENSMUSG00000051695', 'ENSMUSG00000051978', 'ENSMUSG00000052139', 'ENSMUSG00000052253', 'ENSMUSG00000052406', 'ENSMUSG00000052446', 'ENSMUSG00000052456', 'ENSMUSG00000052488', 'ENSMUSG00000052566', 'ENSMUSG00000052712', 'ENSMUSG00000052738', 'ENSMUSG00000052776', 'ENSMUSG00000052794', 'ENSMUSG00000052962', 'ENSMUSG00000053094', 'ENSMUSG00000053293', 'ENSMUSG00000053560', 'ENSMUSG00000053768', 'ENSMUSG00000054021', 'ENSMUSG00000054321', 'ENSMUSG00000054387', 'ENSMUSG00000054469', 'ENSMUSG00000054519', 'ENSMUSG00000054611', 'ENSMUSG00000054612', 'ENSMUSG00000054648', 'ENSMUSG00000054717', 'ENSMUSG00000054723', 'ENSMUSG00000054808', 'ENSMUSG00000054836', 'ENSMUSG00000054945', 'ENSMUSG00000055067', 'ENSMUSG00000055102', 'ENSMUSG00000055228', 'ENSMUSG00000055302', 'ENSMUSG00000055560', 'ENSMUSG00000055652', 'ENSMUSG00000056019', 'ENSMUSG00000056260', 'ENSMUSG00000056300', 'ENSMUSG00000056342', 'ENSMUSG00000056429', 'ENSMUSG00000056536', 'ENSMUSG00000056612', 'ENSMUSG00000056666', 'ENSMUSG00000056692', 'ENSMUSG00000056770', 'ENSMUSG00000056820', 'ENSMUSG00000056952', 'ENSMUSG00000057093', 'ENSMUSG00000057113', 'ENSMUSG00000057181', 'ENSMUSG00000057262', 'ENSMUSG00000057342', 'ENSMUSG00000057375', 'ENSMUSG00000057388', 'ENSMUSG00000057409', 'ENSMUSG00000057522', 'ENSMUSG00000057788', 'ENSMUSG00000057841', 'ENSMUSG00000057858', 'ENSMUSG00000057894', 'ENSMUSG00000057982', 'ENSMUSG00000058064', 'ENSMUSG00000058126', 'ENSMUSG00000058192', 'ENSMUSG00000058301', 'ENSMUSG00000058503', 'ENSMUSG00000058600', 'ENSMUSG00000058979', 'ENSMUSG00000059040', 'ENSMUSG00000059119', 'ENSMUSG00000059273', 'ENSMUSG00000059475', 'ENSMUSG00000059669', 'ENSMUSG00000059878', 'ENSMUSG00000059923', 'ENSMUSG00000060143', 'ENSMUSG00000060227', 'ENSMUSG00000060427', 'ENSMUSG00000060519', 'ENSMUSG00000060657', 'ENSMUSG00000060739', 'ENSMUSG00000060904', 'ENSMUSG00000060950', 'ENSMUSG00000061062', 'ENSMUSG00000061104', 'ENSMUSG00000061118', 'ENSMUSG00000061132', 'ENSMUSG00000061207', 'ENSMUSG00000061474', 'ENSMUSG00000061559', 'ENSMUSG00000061607', 'ENSMUSG00000061838', 'ENSMUSG00000061887', 'ENSMUSG00000061904', 'ENSMUSG00000061983', 'ENSMUSG00000062006', 'ENSMUSG00000062012', 'ENSMUSG00000062040', 'ENSMUSG00000062101', 'ENSMUSG00000062116', 'ENSMUSG00000062175', 'ENSMUSG00000062198', 'ENSMUSG00000062248', 'ENSMUSG00000062382', 'ENSMUSG00000062456', 'ENSMUSG00000062580', 'ENSMUSG00000062901', 'ENSMUSG00000062931', 'ENSMUSG00000063015', 'ENSMUSG00000063052', 'ENSMUSG00000063065', 'ENSMUSG00000063179', 'ENSMUSG00000063200', 'ENSMUSG00000063253', 'ENSMUSG00000063320', 'ENSMUSG00000063334', 'ENSMUSG00000063358', 'ENSMUSG00000063412', 'ENSMUSG00000063445', 'ENSMUSG00000063531', 'ENSMUSG00000063870', 'ENSMUSG00000063882', 'ENSMUSG00000063895', 'ENSMUSG00000064030', 'ENSMUSG00000064090', 'ENSMUSG00000064145', 'ENSMUSG00000064289', 'ENSMUSG00000066009', 'ENSMUSG00000066037', 'ENSMUSG00000066151', 'ENSMUSG00000066441', 'ENSMUSG00000066442', 'ENSMUSG00000066487', 'ENSMUSG00000066551', 'ENSMUSG00000066568', 'ENSMUSG00000066652', 'ENSMUSG00000066705', 'ENSMUSG00000066735', 'ENSMUSG00000067148', 'ENSMUSG00000067365', 'ENSMUSG00000067367', 'ENSMUSG00000067722', 'ENSMUSG00000067851', 'ENSMUSG00000067916', 'ENSMUSG00000068036', 'ENSMUSG00000068206', 'ENSMUSG00000068250', 'ENSMUSG00000068749', 'ENSMUSG00000068856', 'ENSMUSG00000069089', 'ENSMUSG00000069184', 'ENSMUSG00000069208', 'ENSMUSG00000069520', 'ENSMUSG00000069769', 'ENSMUSG00000069899', 'ENSMUSG00000070426', 'ENSMUSG00000070520', 'ENSMUSG00000070605', 'ENSMUSG00000070697', 'ENSMUSG00000070738', 'ENSMUSG00000071172', 'ENSMUSG00000071226', 'ENSMUSG00000071281', 'ENSMUSG00000071379', 'ENSMUSG00000071662', 'ENSMUSG00000072066', 'ENSMUSG00000072244', 'ENSMUSG00000072640', 'ENSMUSG00000072770', 'ENSMUSG00000073423', 'ENSMUSG00000073481', 'ENSMUSG00000073639', 'ENSMUSG00000073640', 'ENSMUSG00000073894', 'ENSMUSG00000074227', 'ENSMUSG00000074272', 'ENSMUSG00000074305', 'ENSMUSG00000074698', 'ENSMUSG00000074731', 'ENSMUSG00000074890', 'ENSMUSG00000075014', 'ENSMUSG00000075023', 'ENSMUSG00000075266', 'ENSMUSG00000075595', 'ENSMUSG00000076431', 'ENSMUSG00000076441', 'ENSMUSG00000078185', 'ENSMUSG00000078193', 'ENSMUSG00000078249', 'ENSMUSG00000078495', 'ENSMUSG00000078496', 'ENSMUSG00000078497', 'ENSMUSG00000078502', 'ENSMUSG00000078503', 'ENSMUSG00000078861', 'ENSMUSG00000078872', 'ENSMUSG00000078974', 'ENSMUSG00000079043', 'ENSMUSG00000079184', 'ENSMUSG00000079259', 'ENSMUSG00000079478', 'ENSMUSG00000079523', 'ENSMUSG00000079555', 'ENSMUSG00000079562', 'ENSMUSG00000079658', 'ENSMUSG00000084786', 'ENSMUSG00000087260', 'ENSMUSG00000087370', 'ENSMUSG00000087598', 'ENSMUSG00000089857', 'ENSMUSG00000090000', 'ENSMUSG00000090290', 'ENSMUSG00000091490', 'ENSMUSG00000091512', 'ENSMUSG00000093904', 'ENSMUSG00000094786', 'ENSMUSG00000094942', 'ENSMUSG00000095677', 'ENSMUSG00000096255', 'ENSMUSG00000096449', 'ENSMUSG00000097333', 'ENSMUSG00000098274', 'ENSMUSG00000102252', 'ENSMUSG00000109511']


def load_rna_counts():
    esc_rna = pd.read_csv( "../../data/RNA_counts_cleaned.txt", sep='\t')
    esc_rna_counts = {}

    cols = esc_rna.columns

    for idx, row in esc_rna.iterrows():
        gene = row["ESC_ens_id"]
        if gene not in esc_rna_counts:
            esc_rna_counts[gene] = {}
        for col in cols:
            if col != "ESC_ens_id":
                esc_rna_counts[gene][col] = row[col]

    return esc_rna_counts


class SingleCellData(Dataset):
    # Dataset class for loading data
    def __init__(self, cell_data, cell_labels, transform=None):
        self.data = []
        for cell, d in cell_data.items():
            for gene, data in d.items():
                self.data.append((torch.cat((data["meth"], data["acc"]), 1).transpose(0,1), data["expr"]))

    def __len__(self):
        return len(self.data)

    def __getitem__(self, i):
        x, y = self.data[i]
        sample = {'geneID': "",
                  'label': y,
                  'input': x,}
        return sample


def load_all_cells(esc_rna_counts, esc_names):

    expr_thresholds = {}
    for gene in selected_genes:
        rna_counts = np.array(list(esc_rna_counts[gene].values()))
        expr_thresholds[gene] = rna_counts.max() / 4

    cell_data = {}
    cell_labels = {}
    windows = BIN_COUNT
    open_labels = 0
    close_labels = 0
    for cell in esc_names:
        data_file_path = DATA_DIR + "Cell_ESC_" + cell + ".all.csv"
        with open(data_file_path) as fi:
            csv_reader = csv.reader(fi, delimiter="\t")
            data = list(csv_reader)
            ncols = (len(data[0]))

        nrows = len(data)
        ngenes = nrows / windows
        nfeatures = ncols - 2
        print("Number of genes: %d" % ngenes)
        print("Number of entries: %d" % nrows)
        print("Number of features: %d" % nfeatures)

        for i in range(0, nrows, windows):
            gene = str(data[i][0])
            if gene not in selected_genes:
                continue
            meth = torch.zeros(windows, 1)
            chrom_acc = torch.zeros(windows, 1)
            for w in range(0, windows):
                meth[w][0] = math.log2(float(data[i + w][2])+1.0)
                chrom_acc[w][0] = math.log2(float(data[i + w][3])+1.0)
            if cell not in cell_data:
                cell_data[cell] = collections.OrderedDict()
                cell_labels[cell] = collections.OrderedDict()
            expr = math.log10(float(esc_rna_counts[gene]["ESC_" + cell])+1.0)
            if expr > 2:
                expr = 1
                open_labels += 1
            else:
                expr = 0
                close_labels += 1

            cell_data[cell][gene] = {"meth": meth, "acc": chrom_acc, "expr": expr}
            cell_labels[cell][gene] = expr

    print("Loaded", len(cell_data))
    print("open", open_labels, "close", close_labels)
    return cell_data, cell_labels


def load_data():
    esc_rna_counts = load_rna_counts()
    count = len(esc_all_names)
    cell_train_names = esc_all_names[0:int(count*0.6)]
    cell_val_names = esc_all_names[int(count*0.6):int(count*0.8)]
    cell_test_names = esc_all_names[int(count*0.8):count]

    print("==>loading train data")
    gene_data = load_all_cells(esc_rna_counts, cell_train_names)
    train_inputs = SingleCellData(*gene_data)
    print("==>loading valid data")
    gene_data = load_all_cells(esc_rna_counts, cell_val_names)
    valid_inputs = SingleCellData(*gene_data)
    print("==>loading test data")
    gene_data = load_all_cells(esc_rna_counts, cell_test_names)
    test_inputs = SingleCellData(*gene_data)

    Train = torch.utils.data.DataLoader(train_inputs, batch_size=BATCH_SIZE)
    Valid = torch.utils.data.DataLoader(valid_inputs, batch_size=BATCH_SIZE)
    Test = torch.utils.data.DataLoader(test_inputs, batch_size=BATCH_SIZE)

    return Train, Valid, Test

